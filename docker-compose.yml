version: '3.8'

services:
  # Main speech-to-text service
  stt-service:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: stt-service
    user: "0:0"
    environment:
      - DISPLAY=${DISPLAY:-:0}
    volumes:
      # X11 socket for GUI access (Linux)
      - /tmp/.X11-unix:/tmp/.X11-unix:rw
      - /dev/snd:/dev/snd:rw  # Audio devices
      - ./config.yaml:/app/config.yaml:ro
      - ./logs:/app/logs:rw
      - ./data:/app/data:rw
    ports:
      - "8080:8080"  # Web interface (future)
    devices:
      - /dev/dri:/dev/dri  # GPU access
    restart: unless-stopped
    # For GUI applications
    security_opt:
      - seccomp:unconfined